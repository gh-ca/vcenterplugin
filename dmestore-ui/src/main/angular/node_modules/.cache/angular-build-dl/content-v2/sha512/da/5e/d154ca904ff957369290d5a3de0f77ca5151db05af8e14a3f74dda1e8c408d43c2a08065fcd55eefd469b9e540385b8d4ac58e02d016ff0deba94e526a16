!function(){function t(t,c){if(!(t instanceof c))throw new TypeError("Cannot call a class as a function")}function c(t,c){for(var e=0;e<c.length;e++){var n=c[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{MEKK:function(e,n,i){"use strict";i.r(n),i.d(n,"IscsiModule",(function(){return E}));var o=i("ofXK"),s=i("tyNb"),r=i("6rlL"),a=i("/Kh9"),l=i("fXoL"),b=i("tk/3"),g=i("3Pt+"),d=i("8MG2"),p=i("sYmb");function m(t,c){if(1&t&&(l.Ub(0,"option",11),l.Kc(1),l.Tb()),2&t){var e=c.$implicit;l.nc("value",e.device),l.Cb(1),l.Nc("",e.ipAddress,"(",e.device,")")}}function u(t,c){if(1&t&&(l.Ub(0,"option",11),l.Kc(1),l.Tb()),2&t){var e=c.$implicit;l.nc("value",e.sn),l.Cb(1),l.Lc(e.name)}}function h(t,c){1&t&&(l.Ub(0,"span"),l.Kc(1,"--"),l.Tb())}function f(t,c){if(1&t&&(l.Ub(0,"span"),l.Kc(1),l.Tb()),2&t){var e=l.gc().$implicit;l.Cb(1),l.Lc(e.mac)}}function C(t,c){1&t&&(l.Ub(0,"span"),l.Kc(1,"--"),l.Tb())}function v(t,c){if(1&t&&(l.Ub(0,"span"),l.Kc(1),l.Tb()),2&t){var e=l.gc().$implicit;l.Cb(1),l.Lc(e.maxSpeed)}}function I(t,c){1&t&&(l.Ub(0,"span"),l.Kc(1,"--"),l.Tb())}function U(t,c){if(1&t&&(l.Ub(0,"span"),l.Kc(1),l.Tb()),2&t){var e=l.gc().$implicit;l.Cb(1),l.Lc(e.mgmtIp)}}function T(t,c){1&t&&(l.Ub(0,"span"),l.Kc(1,"--"),l.Tb())}function K(t,c){if(1&t&&(l.Ub(0,"span"),l.Kc(1),l.Tb()),2&t){var e=l.gc().$implicit;l.Cb(1),l.Lc(e.mgmtIpv6)}}function L(t,c){1&t&&(l.Ub(0,"span"),l.Kc(1,"--"),l.Tb())}function M(t,c){if(1&t&&(l.Ub(0,"span"),l.Kc(1),l.Tb()),2&t){var e=l.gc().$implicit;l.Cb(1),l.Lc(e.speed)}}function D(t,c){1&t&&(l.Ub(0,"span"),l.Pb(1,"span",14),l.Tb()),2&t&&(l.Cb(1),l.Fc("background-color","green"))}function O(t,c){1&t&&(l.Ub(0,"span"),l.Pb(1,"span",14),l.Tb()),2&t&&(l.Cb(1),l.Fc("background-color","red"))}function S(t,c){if(1&t&&(l.Ub(0,"clr-dg-row",12),l.Ub(1,"clr-dg-cell"),l.Kc(2),l.Tb(),l.Ub(3,"clr-dg-cell"),l.Kc(4),l.Tb(),l.Ub(5,"clr-dg-cell"),l.Ic(6,h,2,0,"span",13),l.Ic(7,f,2,1,"span",13),l.Tb(),l.Ub(8,"clr-dg-cell"),l.Ic(9,C,2,0,"span",13),l.Ic(10,v,2,1,"span",13),l.Tb(),l.Ub(11,"clr-dg-cell"),l.Ic(12,I,2,0,"span",13),l.Ic(13,U,2,1,"span",13),l.Tb(),l.Ub(14,"clr-dg-cell"),l.Ic(15,T,2,0,"span",13),l.Ic(16,K,2,1,"span",13),l.Tb(),l.Ub(17,"clr-dg-cell"),l.Ic(18,L,2,0,"span",13),l.Ic(19,M,2,1,"span",13),l.Tb(),l.Ub(20,"clr-dg-cell"),l.Kc(21),l.Tb(),l.Ub(22,"clr-dg-cell"),l.Ic(23,D,2,2,"span",13),l.Ic(24,O,2,2,"span",13),l.Tb(),l.Tb()),2&t){var e=c.$implicit;l.mc("clrDgSelectable","true"==e.connectStatus)("clrDgItem",e),l.Cb(2),l.Lc(e.location),l.Cb(2),l.Lc(e.portName),l.Cb(2),l.mc("ngIf",""==e.mac),l.Cb(1),l.mc("ngIf",""!=e.mac),l.Cb(2),l.mc("ngIf",-1==e.maxSpeed),l.Cb(1),l.mc("ngIf",-1!=e.maxSpeed),l.Cb(2),l.mc("ngIf",""==e.mgmtIp),l.Cb(1),l.mc("ngIf",""!=e.mgmtIp),l.Cb(2),l.mc("ngIf",""==e.mgmtIpv6),l.Cb(1),l.mc("ngIf",""!=e.mgmtIpv6),l.Cb(2),l.mc("ngIf",-1==e.speed),l.Cb(1),l.mc("ngIf",-1!=e.speed),l.Cb(2),l.Lc(e.status),l.Cb(2),l.mc("ngIf","true"==e.connectStatus),l.Cb(1),l.mc("ngIf","false"==e.connectStatus||""==e.mgmtIp||null==e.mgmtIp)}}var y,P,k,w=((y=function(){function e(c,n,i,o){t(this,e),this.cdr=c,this.http=n,this.commonService=i,this.gs=o,this.testPortConnectedUrl="accesshost/testconnectivity",this.portGetUrl="dmestorage/getstorageethports",this.portGetUrlParams={params:{storageSn:""}},this.ipsGetUrl="accessvmware/getvmkernelipbyhostobjectid",this.ipsGetUrlParams={params:{hostObjectId:""}},this.storageGetUrl="dmestorage/storages",this.configIscsiUrl="accesshost/configureiscsi",this.storageDevices=[],this.ips=[],this.configModel={hostObjectId:"",vmKernel:{device:""},ethPorts:[],sn:""},this.hostObjectId="",this.portLoading=!1,this.portList=[],this.portTotal=0}var n,i,o;return n=e,(i=[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var t=this.gs.getClientSdk().app.getContextObjects();console.log(t),this.hostObjectId=null==t?"urn:vmomi:HostSystem:host-1034:674908e5-ab21-4079-9cb1-596358ee5dd1":t[0].id,this.ipsGetUrlParams.params.hostObjectId=this.hostObjectId,this.configModel.hostObjectId=this.hostObjectId,this.loadIps(),this.loadStorageDevice()}},{key:"loadIps",value:function(){var t=this;this.http.get(this.ipsGetUrl,this.ipsGetUrlParams).subscribe((function(c){"0"!==c.code&&"200"!==c.code||(t.ips=c.data,t.cdr.detectChanges())}),(function(t){console.error("ERROR",t)}))}},{key:"loadStorageDevice",value:function(){var t=this;this.http.get(this.storageGetUrl,{}).subscribe((function(c){"200"===c.code&&(t.storageDevices=c.data.data,setTimeout((function(){t.loadPorts()}),1e3),t.cdr.detectChanges())}),(function(t){console.error("ERROR",t)}))}},{key:"loadPorts",value:function(){var t=this;""!==this.configModel.sn&&""!==this.configModel.vmKernel.device&&(this.portLoading=!0,this.portGetUrlParams.params.storageSn=this.configModel.sn,this.http.get(this.portGetUrl,this.portGetUrlParams).subscribe((function(c){"0"!==c.code&&"200"!==c.code||(c.data.forEach((function(t){t.connectStatus=""})),t.portList=c.data,t.portTotal=c.data.length,t.cdr.detectChanges(),t.portLoading=!1,t.testPortConnected())}),(function(c){console.error("ERROR",c),t.portLoading=!1})))}},{key:"testPortConnected",value:function(){var t=this,c=new F,e=[];this.portList.forEach((function(t){t.mgmtIp&&""!=t.mgmtIp&&e.push(t)})),c.ethPorts=e,c.hostObjectId=this.configModel.hostObjectId,c.vmKernel=this.configModel.vmKernel,this.http.post(this.testPortConnectedUrl,c).subscribe((function(c){"200"===c.code&&c.data?(c.data.forEach((function(c){t.portList.forEach((function(t){c.id==t.id&&(t.connectStatus=c.connectStatus)}))})),t.cdr.detectChanges()):alert("\u6d4b\u8bd5\u8fde\u901a\u6027\u51fa\u9519")}),(function(t){console.error("ERROR",t)}))}},{key:"submit",value:function(){console.log(this.configModel),this.http.post(this.configIscsiUrl,this.configModel).subscribe((function(t){}),(function(t){console.error("ERROR",t)}))}}])&&c(n.prototype,i),o&&c(n,o),e}()).\u0275fac=function(t){return new(t||y)(l.Ob(l.h),l.Ob(b.b),l.Ob(r.a),l.Ob(a.b))},y.\u0275cmp=l.Ib({type:y,selectors:[["app-iscsi"]],features:[l.Bb([r.a,a.b])],decls:56,vars:55,consts:[[2,"margin-left","30px"],["clrForm",""],["clrSelect","","name","hostIp",3,"ngModel","change","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["clrSelect","","name","storageDeviceId",3,"ngModel","change","ngModelOptions","ngModelChange"],[2,"margin-top","20px"],[2,"margin-top","2%"],[3,"clrDgSelected","clrDgLoading","clrDgSelectedChange"],[3,"clrDgField"],[3,"clrDgSelectable","clrDgItem",4,"clrDgItems","clrDgItemsOf"],["type","button",1,"btn","btn-primary",2,"display","block","margin","0 auto",3,"click"],[3,"value"],[3,"clrDgSelectable","clrDgItem"],[4,"ngIf"],[1,"color-square"]],template:function(t,c){1&t&&(l.Ub(0,"div"),l.Ub(1,"div",0),l.Ub(2,"div"),l.Ub(3,"form",1),l.Ub(4,"clr-select-container"),l.Ub(5,"label"),l.Kc(6),l.hc(7,"translate"),l.Tb(),l.Kc(8,": "),l.Ub(9,"select",2),l.cc("change",(function(){return c.loadPorts()}))("ngModelOptions",(function(){return c.ips}))("ngModelChange",(function(t){return c.configModel.vmKernel.device=t})),l.Ic(10,m,2,3,"option",3),l.Tb(),l.Tb(),l.Ub(11,"clr-select-container"),l.Ub(12,"label"),l.Kc(13),l.hc(14,"translate"),l.Tb(),l.Kc(15,": "),l.Ub(16,"select",4),l.cc("change",(function(){return c.loadPorts()}))("ngModelOptions",(function(){return c.storageDevices}))("ngModelChange",(function(t){return c.configModel.sn=t})),l.Ic(17,u,2,2,"option",3),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Ub(18,"div",5),l.Ub(19,"p",6),l.Kc(20),l.hc(21,"translate"),l.Tb(),l.Sb(22),l.Ub(23,"clr-datagrid",7),l.cc("clrDgSelectedChange",(function(t){return c.configModel.ethPorts=t})),l.Ub(24,"clr-dg-column",8),l.Kc(25),l.hc(26,"translate"),l.Tb(),l.Ub(27,"clr-dg-column",8),l.Kc(28),l.hc(29,"translate"),l.Tb(),l.Ub(30,"clr-dg-column",8),l.Kc(31),l.hc(32,"translate"),l.Tb(),l.Ub(33,"clr-dg-column",8),l.Kc(34),l.hc(35,"translate"),l.Tb(),l.Ub(36,"clr-dg-column",8),l.Kc(37),l.hc(38,"translate"),l.Tb(),l.Ub(39,"clr-dg-column",8),l.Kc(40),l.hc(41,"translate"),l.Tb(),l.Ub(42,"clr-dg-column",8),l.Kc(43),l.hc(44,"translate"),l.Tb(),l.Ub(45,"clr-dg-column",8),l.Kc(46),l.hc(47,"translate"),l.Tb(),l.Ub(48,"clr-dg-column",8),l.Kc(49),l.hc(50,"translate"),l.Tb(),l.Ic(51,S,25,17,"clr-dg-row",9),l.Tb(),l.Rb(),l.Tb(),l.Ub(52,"div",5),l.Ub(53,"button",10),l.cc("click",(function(){return c.submit()})),l.Kc(54),l.hc(55,"translate"),l.Tb(),l.Tb(),l.Tb(),l.Tb()),2&t&&(l.Cb(6),l.Lc(l.ic(7,29,"iscsi.hostIp")),l.Cb(3),l.mc("ngModel",c.configModel.vmKernel.device),l.Cb(1),l.mc("ngForOf",c.ips),l.Cb(3),l.Lc(l.ic(14,31,"iscsi.storage")),l.Cb(3),l.mc("ngModel",c.configModel.sn),l.Cb(1),l.mc("ngForOf",c.storageDevices),l.Cb(3),l.Lc(l.ic(21,33,"iscsi.ports")),l.Cb(3),l.mc("clrDgSelected",c.configModel.ethPorts)("clrDgLoading",c.portLoading),l.Cb(1),l.mc("clrDgField","location"),l.Cb(1),l.Lc(l.ic(26,35,"iscsi.location")),l.Cb(2),l.mc("clrDgField","portName"),l.Cb(1),l.Lc(l.ic(29,37,"iscsi.portName")),l.Cb(2),l.mc("clrDgField","mac"),l.Cb(1),l.Lc(l.ic(32,39,"iscsi.mac")),l.Cb(2),l.mc("clrDgField","maxSpeed"),l.Cb(1),l.Lc(l.ic(35,41,"iscsi.maxSpeed")),l.Cb(2),l.mc("clrDgField","mgmtIp"),l.Cb(1),l.Lc(l.ic(38,43,"iscsi.ip4")),l.Cb(2),l.mc("clrDgField","mgmtIpv6"),l.Cb(1),l.Lc(l.ic(41,45,"iscsi.ip6")),l.Cb(2),l.mc("clrDgField","speed"),l.Cb(1),l.Lc(l.ic(44,47,"iscsi.speed")),l.Cb(2),l.mc("clrDgField","status"),l.Cb(1),l.Lc(l.ic(47,49,"iscsi.hStatus")),l.Cb(2),l.mc("clrDgField","connectStatus"),l.Cb(1),l.Lc(l.ic(50,51,"iscsi.cStatus")),l.Cb(2),l.mc("clrDgItemsOf",c.portList),l.Cb(3),l.Lc(l.ic(55,53,"menu.ok")))},directives:[g.E,g.r,g.s,d.A,d.W,d.H,g.A,d.V,g.q,g.t,o.m,d.m,d.qb,d.sb,d.lb,d.tb,d.o,d.pb,d.r,g.v,g.D,d.v,d.rb,d.n,d.nb,o.n],pipes:[p.c],styles:[".modal-dialog.modal-lg{width:1280px}.color-square[_ngcontent-%COMP%]{display:inline-block;vertical-align:text-bottom;height:.7rem;width:.7rem;border:.05rem solid #000;border-radius:.2rem}"]}),y),F=function c(){t(this,c)},R=[{path:"",component:w}],j=((P=function c(){t(this,c)}).\u0275mod=l.Mb({type:P}),P.\u0275inj=l.Lb({factory:function(t){return new(t||P)},imports:[[s.i.forChild(R)],s.i]}),P),G=i("M0ag"),E=((k=function c(){t(this,c)}).\u0275mod=l.Mb({type:k}),k.\u0275inj=l.Lb({factory:function(t){return new(t||k)},imports:[[o.c,G.a,j]]}),k)}}])}();