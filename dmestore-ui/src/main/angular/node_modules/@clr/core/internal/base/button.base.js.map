{"version":3,"file":"button.base.js","sourceRoot":"","sources":["../../../../src/internal/base/button.base.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2016-2020 VMware, Inc. All Rights Reserved.\n * This software is released under MIT license.\n * The full license information can be found in LICENSE in the root directory of this project.\n */\n\nimport { html, LitElement, query } from 'lit-element';\nimport { ifDefined } from 'lit-html/directives/if-defined';\n\nimport { property, internalProperty } from '../decorators/property.js';\nimport { querySlot } from '../decorators/query-slot.js';\nimport { onAnyKey } from '../utils/keycodes.js';\nimport { stopEvent } from './../utils/events.js';\n\n// TODO: replace with circular progress bar when complete\nexport const iconSpinnerCheck = html`<span class=\"button-status-icon\" cds-layout=\"horizontal align:center\"\n  ><span class=\"spinner spinner-inline spinner-check\" cds-layout=\"align:center\"></span\n></span>`;\n\nexport const iconSpinner = html`<span class=\"button-status-icon\" cds-layout=\"horizontal align:center\"\n  ><span class=\"spinner spinner-inline\" cds-layout=\"align:center\"></span\n></span>`;\n\nexport const iconSlot = html`<span class=\"button-icon\"><slot name=\"button-icon\"></slot></span>`;\n\nexport const badgeSlot = html`<span class=\"button-badge\"><slot name=\"button-badge\"></slot></span>`;\n\n// @dynamic\nexport class CdsBaseButton extends LitElement {\n  @property({ type: Boolean }) readonly = false;\n\n  @property({ type: String }) type: 'button' | 'submit';\n\n  @property({ type: String }) name: string;\n\n  @property({ type: String }) value: string;\n\n  @property({ type: Boolean }) disabled = false;\n\n  @internalProperty({ type: Number, attribute: 'tabindex', reflect: true }) protected tabIndexAttr: number | null; // don't override native prop as it stops native focus behavior\n\n  @internalProperty({ type: Boolean, reflect: true }) protected focused = false;\n\n  @internalProperty({ type: String, reflect: true }) protected role: string | null = 'button';\n\n  /** @deprecated slotted anchor deprecated in 4.0 in favor of wrapping element */\n  @internalProperty({ type: Boolean, reflect: true }) protected containsAnchor = false;\n\n  /** @deprecated slotted anchor deprecated in 4.0 in favor of wrapping element */\n  @querySlot('a') protected anchor: HTMLAnchorElement;\n\n  @internalProperty({ type: Boolean, reflect: true }) protected isAnchor = false;\n\n  @querySlot('cds-icon') protected icon: HTMLElement;\n\n  @querySlot('cds-badge') protected badge: HTMLElement;\n\n  protected get hiddenButtonTemplate() {\n    return this.readonly\n      ? html``\n      : html`<button\n          aria-hidden=\"true\"\n          ?disabled=\"${this.disabled}\"\n          tabindex=\"-1\"\n          style=\"display: none\"\n          value=\"${ifDefined(this.value)}\"\n          name=\"${ifDefined(this.name)}\"\n          type=\"${ifDefined(this.type)}\"\n        ></button>`;\n  }\n\n  @query('button') private templateButton: HTMLButtonElement;\n  private hiddenButton: HTMLButtonElement;\n\n  protected render() {\n    return html`\n      <slot></slot>\n      ${this.hiddenButtonTemplate}\n    `;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.tabIndex = 0; // initialize immediately so button can be focused synchronously\n  }\n\n  protected firstUpdated(props: Map<string, any>) {\n    super.firstUpdated(props);\n    this.setupAnchorFocus();\n    this.setupNativeButtonBehavior();\n  }\n\n  protected updated(props: Map<string, any>) {\n    super.updated(props);\n    this.updateButtonAttributes();\n  }\n\n  private setupAnchorFocus() {\n    if (this.anchor) {\n      this.anchor.addEventListener('focusin', () => (this.focused = true));\n      this.anchor.addEventListener('focusout', () => (this.focused = false));\n    }\n  }\n\n  /**\n   * We have to append a hidden button outside the web component in the light DOM\n   * This allows us to trigger native submit events within a form element.\n   */\n  private setupNativeButtonBehavior() {\n    this.appendHiddenButton();\n    this.addEventListener('click', this.triggerNativeButtonBehavior);\n    this.addEventListener('keydown', this.emulateKeyBoardEventBehavior);\n  }\n\n  private triggerNativeButtonBehavior(event: Event) {\n    if (!this.readonly) {\n      if (this.disabled) {\n        stopEvent(event);\n      } else if (event.target === this && !event.defaultPrevented) {\n        this.hiddenButton.dispatchEvent(new MouseEvent('click', { relatedTarget: this, composed: true }));\n      }\n    }\n  }\n\n  private appendHiddenButton() {\n    if (!this.hiddenButton && this.templateButton) {\n      this.hiddenButton = this.appendChild(this.templateButton);\n    }\n  }\n\n  private emulateKeyBoardEventBehavior(evt: KeyboardEvent) {\n    if (this.anchor) {\n      return;\n    }\n\n    onAnyKey(['enter', 'space'], evt, () => {\n      this.click();\n      stopEvent(evt);\n    });\n  }\n\n  private updateButtonAttributes() {\n    this.containsAnchor = !!this.anchor;\n    this.isAnchor = this.parentElement?.tagName === 'A';\n\n    if (this.isAnchor && this.parentElement) {\n      this.parentElement.style.lineHeight = '0';\n      this.parentElement.style.textDecoration = 'none'; // fixes issue when style is applied to text node\n    }\n\n    this.readonly = this.readonly || this.containsAnchor || this.isAnchor;\n    this.role = this.readonly ? null : 'button';\n\n    if (this.readonly) {\n      this.tabIndexAttr = null;\n    } else {\n      this.tabIndexAttr = this.disabled ? -1 : 0;\n    }\n  }\n}\n"]}